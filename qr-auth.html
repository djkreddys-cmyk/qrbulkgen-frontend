<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Account â€” QRBulkGen</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col">

<header class="bg-white shadow p-4 flex justify-between items-center">
  <a href="index.html" class="text-xl font-bold text-indigo-600">QRBulkGen</a>
</header>

<div class="flex-grow flex items-center justify-center px-4">
  <div class="bg-white w-full max-w-md rounded-2xl shadow-xl p-8">


<h2 id="title" class="text-2xl font-bold text-center mb-6">Create Account</h2>
<p id="msg" class="text-center text-sm mb-4"></p>

<!-- NAME -->
<input id="name" type="text" placeholder="Your Name"
  class="w-full border rounded-lg px-4 py-3 mb-3" />

<!-- EMAIL -->
<input id="email" type="email" placeholder="Email"
  class="w-full border rounded-lg px-4 py-3 mb-3" />

<!-- PASSWORD -->
<input id="password" type="password" placeholder="Password"
  class="w-full border rounded-lg px-4 py-3 mb-3" />

<!-- FORGOT PASSWORD (LOGIN ONLY) -->
<div id="forgotBox" class="text-right mb-3 hidden">
  <button onclick="forgotPassword()" class="text-sm text-indigo-600 hover:underline">
    Forgot Password?
  </button>
</div>

<!-- MAIN BUTTON -->
<button id="mainBtn"
  class="w-full bg-indigo-600 text-white py-3 rounded-lg mb-4 hover:bg-indigo-700">
  Register
</button>

<!-- SWITCH MODE -->
<p class="text-center text-sm">
  <span id="switchText">Already registered?</span>
  <button onclick="toggleMode()" class="text-indigo-600 font-semibold">Login</button>
</p>


  </div>
</div>

<script>
const API="https://qrbulkgen-backend-production.up.railway.app/api";

let isLogin=false;

const nameEl=document.getElementById("name");
const emailEl=document.getElementById("email");
const passwordEl=document.getElementById("password");
const title=document.getElementById("title");
const mainBtn=document.getElementById("mainBtn");
const switchText=document.getElementById("switchText");
const forgotBox=document.getElementById("forgotBox");
const msg=document.getElementById("msg");

function show(t,color="red"){
 msg.innerText=t;
 msg.className="text-center text-sm mb-4 text-"+color+"-600";
}

// SWITCH BETWEEN LOGIN & REGISTER
function toggleMode(){
isLogin=!isLogin;

if(isLogin){
title.innerText="Login";
mainBtn.innerText="Login";
nameEl.style.display="none";
forgotBox.classList.remove("hidden");
switchText.innerText="New here?";
document.querySelector("#switchText + button").innerText="Register";
}else{
title.innerText="Create Account";
mainBtn.innerText="Register";
nameEl.style.display="block";
forgotBox.classList.add("hidden");
switchText.innerText="Already registered?";
document.querySelector("#switchText + button").innerText="Login";
}
}
// MAIN ACTION
mainBtn.onclick=async()=>{

 const email=emailEl.value.trim();
 const password=passwordEl.value.trim();

 if(isLogin){
   const r=await fetch(API+"/login",{
     method:"POST",
     headers:{'Content-Type':'application/json'},
     body:JSON.stringify({email,password})
   });

   if(r.status!==200){ show("Invalid login"); return; }

   const data=await r.json();
   localStorage.setItem("token",data.token);
   window.location="qr-dashboard.html";

 }else{

   const name=nameEl.value.trim();
   if(!name||!email||!password){ show("Fill all fields"); return; }

   const r=await fetch(API+"/register",{
     method:"POST",
     headers:{'Content-Type':'application/json'},
     body:JSON.stringify({name,email,password})
   });

   show(await r.text(),"green");
 }
};
  async function resetPassword(){
  const email=document.getElementById("resetEmail").value.trim();
  const newPassword=document.getElementById("resetPassword").value.trim();

  if(!email||!newPassword){
    alert("Enter email and new password");
    return;
  }

  const r=await fetch(API+"/reset-password",{
    method:"POST",
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({email,newPassword})
  });

  const txt=await r.text();
  alert(txt);

  if(r.ok){
    closeResetModal();
  }
}

</script>
<!-- RESET PASSWORD MODAL -->
<div id="resetModal" class="fixed inset-0 bg-black/40 hidden items-center justify-center z-50">
  <div class="bg-white w-full max-w-sm rounded-2xl p-6 shadow-xl">

    <h3 class="text-xl font-bold mb-4 text-center">Reset Password</h3>

    <input id="resetEmail" type="email" placeholder="Registered Email"
      class="w-full border rounded-lg px-4 py-3 mb-3" />

    <input id="resetPassword" type="password" placeholder="New Password"
      class="w-full border rounded-lg px-4 py-3 mb-4" />

    <button onclick="resetPassword()"
      class="w-full bg-indigo-600 text-white py-3 rounded-lg mb-2">
      Update Password
    </button>

    <button onclick="closeResetModal()"
      class="w-full text-gray-500">
      Cancel
    </button>

  </div>
</div>
</body>
</html>



