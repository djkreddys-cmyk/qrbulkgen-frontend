<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QRBulkGen Login</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center">

<div class="bg-white shadow-2xl rounded-2xl p-8 w-full max-w-md">

<h1 class="text-2xl font-bold text-center mb-6">QRBulkGen Account</h1>

<div id="msg" class="text-center mb-4 text-sm"></div>

<input id="email" type="email" placeholder="Enter Email"
    class="w-full px-4 py-2 border rounded-lg mb-3">

<input id="password" type="password" placeholder="Enter Password"
    class="w-full px-4 py-2 border rounded-lg mb-5">

<button onclick="registerUser()"
    class="w-full bg-blue-600 text-white py-2 rounded-lg mb-3 hover:bg-blue-700">
    Register
</button>

<button onclick="loginUser()"
    class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">
    Login
</button>

</div>

<script>
const API="https://qrbulkgen-backend-production.up.railway.app";

function msg(text,color="red"){
  const el=document.getElementById("msg");
  el.innerText=text;
  el.className="text-center mb-4 text-"+color+"-600";
}

async function registerUser(){
 const email=document.getElementById("email").value;
 const password=document.getElementById("password").value;

 const res=await fetch(API+"/api/register",{
  method:"POST",
  headers:{"Content-Type":"application/json"},
  body:JSON.stringify({email,password})
 });

 const txt=await res.text();
 if(res.ok) msg("Registered successfully!","green");
 else msg(txt);
}

async function loginUser(){
 const email=document.getElementById("email").value;
 const password=document.getElementById("password").value;

 const res=await fetch(API+"/api/login",{
  method:"POST",
  headers:{"Content-Type":"application/json"},
  body:JSON.stringify({email,password})
 });

 if(!res.ok){
   const txt=await res.text();
   return msg(txt);
 }

 const data=await res.json();
 localStorage.setItem("token",data.token);
 localStorage.setItem("plan",data.plan);

 msg("Login success","green");
 setTimeout(()=>location.href="/qr-dashboard.html",800);
}
</script>

</body>
</html>

