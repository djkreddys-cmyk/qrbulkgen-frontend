<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Bulk QR Upload — QRBulkGen</title>

<script src="https://cdn.tailwindcss.com"></script>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<script src="https://unpkg.com/qr-code-styling@1.6.0/lib/qr-code-styling.js"></script>

<script src="js/auth.js"></script>

<style>
.qrTab{padding:10px 14px;border-radius:10px;color:#374151;white-space:nowrap}
.qrTab:hover{background:#eef2ff;color:#4f46e5}
.qrTab.active{background:#4f46e5;color:white}
</style>

</head>

<body class="bg-gray-100">

<!-- NAVBAR -->

<header class="bg-white shadow sticky top-0 z-50">
<div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">

<a id="logoLink" href="qr-dashboard.html" class="text-xl font-bold text-indigo-600">QRBulkGen</a>

<div class="flex items-center gap-6">
<div id="navLinks" class="hidden md:flex gap-6">
<a href="qr-single.html">Generate QR</a>
<a href="qr-bulk.html" class="font-semibold text-indigo-600">Bulk Upload</a>
<a href="qr-dashboard.html">Dashboard</a>
</div>
<div id="navUser"></div>
</div>

</div>
</header>

<!-- TYPE SLIDER -->

<div class="bg-white border-b sticky top-[72px] z-40">
<div class="max-w-7xl mx-auto flex items-center px-2">

<button id="leftArrow" onclick="slideTabs(-1)" class="p-2 text-xl">◀</button>

<div id="tabsWrapper" class="overflow-hidden flex-1">
<div id="tabs" class="flex gap-4 py-3 transition-all duration-300">
<div id="tabs" class="flex gap-4 py-3 transition-all duration-300">

<button class="qrTab active" onclick="selectType('text',this)">Text</button>
<button class="qrTab" onclick="selectType('url',this)">Website</button>
<button class="qrTab" onclick="selectType('whatsapp',this)">WhatsApp</button>
<button class="qrTab" onclick="selectType('wifi',this)">WiFi</button>
<button class="qrTab" onclick="selectType('upi',this)">UPI</button>
<button class="qrTab" onclick="selectType('email',this)">Email</button>
<button class="qrTab" onclick="selectType('phone',this)">Phone</button>
<button class="qrTab" onclick="selectType('location',this)">Location</button>
<button class="qrTab" onclick="selectType('vcard',this)">Business Card</button>
<button class="qrTab" onclick="selectType('menu',this)">Restaurant Menu</button>
<button class="qrTab" onclick="selectType('product',this)">Product Label</button>
<button class="qrTab" onclick="selectType('ticket',this)">Event Ticket</button>

</div>


</div>
</div>

<button id="rightArrow" onclick="slideTabs(1)" class="p-2 text-xl">▶</button>

</div>
</div>

<!-- CONTENT -->

<div class="max-w-7xl mx-auto p-6 grid md:grid-cols-2 gap-8">

<!-- LEFT PANEL -->

<div class="bg-white rounded-2xl shadow p-6">

<h2 class="text-xl font-bold mb-4">Bulk QR Upload</h2>

<!-- STEP 1 -->

<div class="mb-6">
<h3 class="font-semibold mb-2">Step 1 — Download Sample</h3>
<button onclick="downloadSample()" class="bg-indigo-600 text-white px-5 py-2 rounded-xl">
Download Sample Excel
</button>
<p class="text-sm text-gray-500 mt-2">Fill sample file before upload.</p>
</div>

<!-- STEP 2 -->

<div class="mb-6">
<h3 class="font-semibold mb-2">Step 2 — Upload Excel</h3>
<input type="file" id="excelFile" accept=".xlsx,.xls,.csv"
class="w-full border rounded-xl p-3">
<p id="fileName" class="text-sm text-gray-500 mt-2"></p>
</div>

<!-- STEP 3 -->

<div class="mb-6">
<h3 class="font-semibold mb-2">Step 3 — Load Data</h3>
<button onclick="processExcel()" class="bg-green-600 text-white px-6 py-3 rounded-xl w-full">
Load Excel Data
</button>
<p id="rowsInfo" class="text-sm text-gray-500 mt-3"></p>
</div>

<!-- CUSTOMIZATION -->

<div id="customizationArea"></div>

</div>

<!-- RIGHT PANEL -->

<div class="bg-white rounded-2xl shadow p-6">
<h2 class="text-xl font-semibold mb-4">Preview Data</h2>
<div id="previewTable" class="overflow-auto max-h-[450px] text-sm"></div>
</div>

</div>

<script>

let currentType="text";
let tabPosition=0;
let excelData=[];

/* SLIDER */
function slideTabs(dir){
const wrapper=document.getElementById("tabsWrapper");
const tabs=document.getElementById("tabs");
const maxScroll=tabs.scrollWidth-wrapper.clientWidth;

tabPosition+=dir*200;
if(tabPosition<0)tabPosition=0;
if(tabPosition>maxScroll)tabPosition=maxScroll;

tabs.style.transform=`translateX(-${tabPosition}px)`;
}

/* SELECT TYPE */
function selectType(type,el){
currentType=type;
document.querySelectorAll(".qrTab").forEach(t=>t.classList.remove("active"));
el.classList.add("active");
}

/* FILE NAME */
document.getElementById("excelFile").addEventListener("change", e=>{
document.getElementById("fileName").innerText =
e.target.files[0] ? "Selected: "+e.target.files[0].name : "";
});

/* SAMPLE DOWNLOAD */
function downloadSample(){
let headers=["data"];
switch(currentType){
case "text":
headers=["text"];
break;
case "url":
headers=["url"];
break;
case "whatsapp":
headers=["phone","message"];
break;
case "wifi":
headers=["ssid","password"];
break;
case "upi":
headers=["upi_id","amount"];
break;
case "email":
headers=["email","subject"];
break;
case "phone":
headers=["phone"];
break;
case "location":
headers=["address"];
break;
case "vcard":
headers=["name","company","phone"];
break;
case "menu":
headers=["menu_url"];
break;
case "product":
headers=["product_name","product_code"];
break;
case "ticket":
headers=["event","seat","date"];
break;
}
/* create excel */
const ws=XLSX.utils.aoa_to_sheet([headers]);
const wb=XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb,ws,"Sample");
XLSX.writeFile(wb, currentType+"_sample.xlsx");
}
/* PROCESS EXCEL */
function processExcel(){
const file=document.getElementById("excelFile").files[0];
if(!file)return alert("Upload Excel first");
const reader=new FileReader();
reader.onload=function(e){
const data=new Uint8Array(e.target.result);
const workbook=XLSX.read(data,{type:"array"});
const sheet=workbook.Sheets[workbook.SheetNames[0]];
excelData=XLSX.utils.sheet_to_json(sheet);
document.getElementById("rowsInfo").innerText =
excelData.length+" rows loaded successfully";
renderPreview();
};
reader.readAsArrayBuffer(file);
}
/* PREVIEW TABLE */
function renderPreview(){
if(excelData.length===0)return;
let html="<table class='w-full border'>";
html+="<tr>";
Object.keys(excelData[0]).forEach(h=>{
html+=`<th class="border px-2 py-1 bg-gray-100">${h}</th>`;
});
html+="</tr>";
excelData.forEach(row=>{
html+="<tr>";
Object.values(row).forEach(v=>{
html+=`<td class="border px-2 py-1">${v??""}</td>`;
});
html+="</tr>";
});
html+="</table>";
document.getElementById("previewTable").innerHTML=html;
}
</script>
</body>
</html>


