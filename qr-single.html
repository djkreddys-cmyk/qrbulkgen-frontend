<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Generate QR — QRBulkGen</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="js/auth.js"></script>

<style>
.qrTab{padding:10px 14px;border-radius:10px;color:#374151;white-space:nowrap}
.qrTab:hover{background:#eef2ff;color:#4f46e5}
.qrTab.active{background:#4f46e5;color:white}
.btnGen{width:100%;background:#4f46e5;color:white;padding:12px;border-radius:12px}
</style>
</head>

<body class="bg-gray-100">

<!-- NAVBAR -->
<header class="bg-white shadow sticky top-0 z-50">
<div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">

<a id="logoLink" href="qr-dashboard.html" class="text-xl font-bold text-indigo-600">
QRBulkGen
</a>

<div class="flex items-center gap-6">
<div id="navLinks" class="hidden md:flex gap-6">
<a href="qr-single.html">Generate QR</a>
<a href="qr-bulk.html">Bulk Upload</a>
<a href="qr-dashboard.html">Dashboard</a>
</div>
<div id="navUser"></div>
</div>

</div>
</header>

<!-- TYPE SLIDER -->
<div class="bg-white border-b sticky top-[72px] z-40">
<div class="max-w-7xl mx-auto flex items-center px-2">

<button onclick="slideTabs(-1)" class="p-2 text-xl">◀</button>

<div id="tabsWrapper" class="overflow-hidden flex-1">
<div id="tabs" class="flex gap-4 py-3 transition-all duration-300">

<button class="qrTab active" onclick="selectType('text',this)">Text</button>
<button class="qrTab" onclick="selectType('url',this)">Website</button>
<button class="qrTab" onclick="selectType('whatsapp',this)">WhatsApp</button>
<button class="qrTab" onclick="selectType('wifi',this)">WiFi</button>
<button class="qrTab" onclick="selectType('upi',this)">UPI</button>
<button class="qrTab" onclick="selectType('email',this)">Email</button>
<button class="qrTab" onclick="selectType('phone',this)">Phone</button>
<button class="qrTab" onclick="selectType('location',this)">Location</button>
<button class="qrTab" onclick="selectType('vcard',this)">Business Card</button>
<button class="qrTab" onclick="selectType('menu',this)">Restaurant Menu</button>
<button class="qrTab" onclick="selectType('product',this)">Product Label</button>
<button class="qrTab" onclick="selectType('ticket',this)">Event Ticket</button>

</div>
</div>

<button onclick="slideTabs(1)" class="p-2 text-xl">▶</button>

</div>
</div>

<!-- CONTENT -->
<div class="max-w-7xl mx-auto p-6 grid md:grid-cols-2 gap-8">

<div id="formArea" class="bg-white rounded-2xl shadow p-6"></div>

<div class="bg-white rounded-2xl shadow p-6 flex flex-col items-center">
<h2 class="text-xl font-semibold mb-4">Live Preview</h2>
<div id="qrcode" class="p-6 bg-white"></div>
<button onclick="downloadQR()" class="mt-6 bg-green-600 text-white px-6 py-3 rounded-xl">
Download PNG
</button>
</div>

</div>

<script>
let currentType="text";
let qr;
let tabPosition=0;

function slideTabs(dir){
const tabs=document.getElementById("tabs");
tabPosition+=dir*200;
if(tabPosition<0)tabPosition=0;
tabs.style.transform=`translateX(-${tabPosition}px)`;
}

function selectType(type,el){
currentType=type;
document.querySelectorAll(".qrTab").forEach(t=>t.classList.remove("active"));
el.classList.add("active");
renderForm();
}

function input(id,placeholder){
return `<input id="${id}" placeholder="${placeholder}" class="w-full border rounded-xl p-3 mb-3" oninput="autoQR()">`;
}

function renderForm(){
const a=document.getElementById("formArea");

const forms={
text:`<h2 class="text-xl font-bold mb-4">Text QR</h2>${input('data','Enter text')}`,
url:`<h2 class="text-xl font-bold mb-4">Website</h2>${input('data','https://example.com')}`,
whatsapp:`<h2 class="text-xl font-bold mb-4">WhatsApp</h2>${input('phone','Phone')}${input('msg','Message')}`,
wifi:`<h2 class="text-xl font-bold mb-4">WiFi</h2>${input('ssid','Network Name')}${input('pass','Password')}`,
upi:`<h2 class="text-xl font-bold mb-4">UPI</h2>${input('upi','UPI ID')}${input('amount','Amount')}`,
email:`<h2 class="text-xl font-bold mb-4">Email</h2>${input('mail','Email')}${input('subject','Subject')}`,
phone:`<h2 class="text-xl font-bold mb-4">Phone</h2>${input('call','Phone Number')}`,
location:`<h2 class="text-xl font-bold mb-4">Location</h2>
<div id="locationBox" class="hidden qr-section">
  <label class="font-medium">Enter Address</label>
  <input id="addressInput" type="text" placeholder="Search location..."
    class="w-full border rounded-xl p-3 mt-2">

  <p class="text-sm text-gray-500 mt-2">
    Start typing and choose suggestion
  </p>
</div>
menu:`<h2 class="text-xl font-bold mb-4">Restaurant Menu</h2>${input('menuUrl','Menu URL')}`,
product:`<h2 class="text-xl font-bold mb-4">Product Label</h2>${input('productName','Product Name')}${input('productCode','SKU Code')}`,
ticket:`<h2 class="text-xl font-bold mb-4">Event Ticket</h2>${input('eventName','Event')}${input('seat','Seat')}${input('date','Date')}`,
vcard:`<h2 class="text-xl font-bold mb-4">Business Card</h2>${input('name','Name')}${input('org','Company')}${input('tel','Phone')}`
};

a.innerHTML=forms[currentType];
}

function autoQR(){ generateQR(); }

function generateQR(){
let d="";

try{
switch(currentType){
case"whatsapp":d=`https://wa.me/${phone.value}?text=${encodeURIComponent(msg.value)}`;break;
case"wifi":d=`WIFI:T:WPA;S:${ssid.value};P:${pass.value};;`;break;
case"upi":d=`upi://pay?pa=${upi.value}&am=${amount.value}`;break;
case"email":d=`mailto:${mail.value}?subject=${subject.value}`;break;
case"phone":d=`tel:${call.value}`;break;
case"location":d=`https://maps.google.com/?q=${lat.value},${lng.value}`;break;
case"menu":d=menuUrl.value;break;
case"product":d=`Product:${productName.value}\nCode:${productCode.value}`;break;
case"ticket":d=`Event:${eventName.value}\nSeat:${seat.value}\nDate:${date.value}`;break;
case"vcard":d=`BEGIN:VCARD\nVERSION:3.0\nFN:${name.value}\nORG:${org.value}\nTEL:${tel.value}\nEND:VCARD`;break;
default:d=data?.value||"";
}

createQR(d);
}catch{}
}

function createQR(text){
const c=document.getElementById("qrcode");
c.innerHTML="";
qr=new QRCode(c,{text,width:260,height:260});
}

function downloadQR(){
const img=document.querySelector("#qrcode img");
if(!img)return alert("Generate QR first");
const a=document.createElement("a");
a.href=img.src;
a.download="qr-code.png";
a.click();
}
function generateQR(customText){

  const text = customText || document.getElementById('qrInput').value || 'QRBulkGen';
  const color = document.getElementById('color').value;
  const container = document.getElementById('qrcode');

  container.innerHTML='';

  new QRCode(container,{
    text:text,
    width:260,
    height:260,
    colorDark:color,
    colorLight:'#ffffff'
  });
}
renderForm();
</script>
<script src="js/protect.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script>
<script>
let selectedPlace = null;

function initLocationAutocomplete(){

  const input = document.getElementById("addressInput");
  if(!input) return;

  const autocomplete = new google.maps.places.Autocomplete(input);

  autocomplete.addListener("place_changed", function(){

    const place = autocomplete.getPlace();

    if(!place.geometry){
      alert("Please select location from list");
      return;
    }

    const lat = place.geometry.location.lat();
    const lng = place.geometry.location.lng();

    // Save Google Maps link
    selectedPlace = `https://maps.google.com/?q=${lat},${lng}`;

    // Auto generate QR preview
    generateQR(selectedPlace);
  });
}

window.addEventListener("load", initLocationAutocomplete);
</script>
</body>
</html>

