<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Generate QR — QRBulkGen</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
.qrTab{
  padding:10px 18px;
  border-radius:999px;
  background:#f3f4f6;
  cursor:pointer;
  white-space:nowrap;
}
.qrTab.active{
  background:#4f46e5;
  color:white;
}
</style>
</head>

<body class="bg-gray-100">

<!-- NAVBAR -->
<header class="bg-white shadow sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between">
    <a href="qr-dashboard.html" class="text-xl font-bold text-indigo-600">QRBulkGen</a>
    <div id="navUser"></div>
  </div>
</header>

<div class="max-w-7xl mx-auto mt-6 grid md:grid-cols-2 gap-8 px-6">

<!-- LEFT PANEL -->
<div class="bg-white rounded-2xl shadow p-6">

<!-- TYPE SELECTOR -->
<div class="flex gap-3 overflow-x-auto pb-3 mb-6">

<button class="qrTab active" onclick="selectType('text',this)">Text</button>
<button class="qrTab" onclick="selectType('url',this)">Website</button>
<button class="qrTab" onclick="selectType('email',this)">Email</button>
<button class="qrTab" onclick="selectType('phone',this)">Phone</button>
<button class="qrTab" onclick="selectType('wifi',this)">WiFi</button>
<button class="qrTab" onclick="selectType('whatsapp',this)">WhatsApp</button>
<button class="qrTab" onclick="selectType('location',this)">Location</button>
<button class="qrTab" onclick="selectType('vcard',this)">Business Card</button>
<button class="qrTab" onclick="selectType('product',this)">Product Label</button>
<button class="qrTab" onclick="selectType('ticket',this)">Event Ticket</button>
<button class="qrTab" onclick="selectType('menu',this)">Restaurant Menu</button>

</div>

<div id="formArea"></div>

</div>

<!-- RIGHT PREVIEW -->
<div class="bg-white rounded-2xl shadow p-6 flex flex-col items-center">
<h2 class="text-xl font-bold mb-6">Live Preview</h2>

<div id="qrcode" class="p-4 bg-white"></div>

<button onclick="downloadQR()" class="mt-6 bg-green-600 text-white px-6 py-3 rounded-xl">
Download PNG
</button>
</div>

</div>

<script>
let currentType="text";
let qr;

function selectType(type,el){
currentType=type;
document.querySelectorAll(".qrTab").forEach(t=>t.classList.remove("active"));
el.classList.add("active");
renderForm();

if(type==="location"){
 setTimeout(initLocationAutocomplete,200);
}
}

/* ----------------- FORM RENDER ------------------ */
function renderForm(){

const forms={

text:`<input id="data" placeholder="Enter text" class="w-full border rounded-xl p-3">`,

url:`<input id="data" placeholder="https://example.com" class="w-full border rounded-xl p-3">`,

email:`<input id="email" placeholder="Email">
<input id="subject" placeholder="Subject" class="mt-2">
<input id="body" placeholder="Message" class="mt-2">`,

phone:`<input id="phone" placeholder="+91xxxxxxxxxx" class="w-full border rounded-xl p-3">`,

wifi:`<input id="ssid" placeholder="WiFi Name">
<input id="pass" placeholder="Password" class="mt-2">`,

whatsapp:`<input id="wa" placeholder="919999999999">
<input id="msg" placeholder="Message" class="mt-2">`,

location:`<input id="addressInput" placeholder="Search address" class="w-full border rounded-xl p-3">`,

vcard:`<input id="name" placeholder="Name">
<input id="org" placeholder="Company" class="mt-2">
<input id="phone" placeholder="Phone" class="mt-2">
<input id="email" placeholder="Email" class="mt-2">`,

product:`<input id="pname" placeholder="Product name">
<input id="price" placeholder="Price" class="mt-2">`,

ticket:`<input id="event" placeholder="Event name">
<input id="date" placeholder="Date" class="mt-2">
<input id="seat" placeholder="Seat" class="mt-2">`,

menu:`<input id="url" placeholder="Menu URL">`
};

document.getElementById("formArea").innerHTML=forms[currentType];
}

/* ----------------- QR CREATE ------------------ */

function createQR(data){
const container=document.getElementById("qrcode");
container.innerHTML="";
qr=new QRCode(container,{text:data,width:260,height:260});
}

/* ----------------- GENERATE ------------------ */

document.addEventListener("input",()=>{
try{

let d="";

switch(currentType){

case"text": d=data.value; break;
case"url": d=data.value; break;
case"email": d=`mailto:${email.value}?subject=${subject.value}&body=${body.value}`; break;
case"phone": d=`tel:${phone.value}`; break;
case"wifi": d=`WIFI:T:WPA;S:${ssid.value};P:${pass.value};;`; break;
case"whatsapp": d=`https://wa.me/${wa.value}?text=${msg.value}`; break;
case"vcard": d=`BEGIN:VCARD
FN:${name.value}
ORG:${org.value}
TEL:${phone.value}
EMAIL:${email.value}
END:VCARD`; break;
case"product": d=`${pname.value} - ₹${price.value}`; break;
case"ticket": d=`${event.value} | ${date.value} | ${seat.value}`; break;
case"menu": d=url.value; break;
default:return;
}

if(d) createQR(d);

}catch(e){}
});

/* ----------------- DOWNLOAD ------------------ */
function downloadQR(){
const canvas=document.querySelector("#qrcode canvas");
if(!canvas)return alert("Generate QR first");
const link=document.createElement("a");
link.href=canvas.toDataURL();
link.download="qr.png";
link.click();
}

/* ----------------- GOOGLE LOCATION ------------------ */

let autocomplete;

function initLocationAutocomplete(){
const input=document.getElementById("addressInput");
if(!input)return;

autocomplete=new google.maps.places.Autocomplete(input,{fields:["geometry"]});

autocomplete.addListener("place_changed",()=>{
const place=autocomplete.getPlace();
if(!place.geometry)return alert("Select address");

const lat=place.geometry.location.lat();
const lng=place.geometry.location.lng();

createQR(`https://maps.google.com/?q=${lat},${lng}`);
});
}

renderForm();
</script>

<!-- GOOGLE MAPS -->
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_API_KEY&libraries=places">
</script>

<script src="js/auth.js"></script>

</body>
</html>
